select 
TRX.TRX_NOME AS Nome_motorista,
ST9.T9_nome as Descricao_veiculo,
TRX.TRX_CODBEM AS BEM,
TRX.TRX_VALOR as VALOR,
TRX.TRX_DESCON AS DESCONTO,
TRX.TRX_VALOR - TRX.TRX_DESCON AS VALOR_TOTAL,
TRX.TRX_TPMULT AS TIPO_MULTA,
CASE 
    WHEN TRX.TRX_DTEMIS <> ' ' THEN TO_DATE(TRX.TRX_DTEMIS, 'YYYYMMDD') 
    ELSE TO_DATE('19000101', 'YYYYMMDD') 
    END AS DATA_EMISSAO,
CASE 
    WHEN TRX.TRX_DTVECI <> ' ' THEN TO_DATE(TRX.TRX_DTVECI, 'YYYYMMDD') 
    ELSE TO_DATE('19000101', 'YYYYMMDD') 
    END AS DATA_VENCIMENTO,    
CASE 
    WHEN TRX.TRX_DTPGTO <> ' ' THEN TO_DATE(TRX.TRX_DTPGTO, 'YYYYMMDD') 
    ELSE TO_DATE('19000101', 'YYYYMMDD') 
    END AS DATA_PAGAMENTO,
CASE 
    WHEN TRX.TRX_DTDIGI <> ' ' THEN TO_DATE(TRX.TRX_DTDIGI, 'YYYYMMDD') 
    ELSE TO_DATE('19000101', 'YYYYMMDD') 
    END AS DATA_DIGITACAO    
from protheus.trx010 trx
LEFT JOIN  PROTHEUS.ST9010 ST9 ON TRX.TRX_CODBEM = ST9.T9_CODBEM 
WHERE TRX_FILIAL = 010001 and trx.D_E_L_E_T_<>'*'
